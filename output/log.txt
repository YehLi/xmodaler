[07/05 17:43:54] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:43:55] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:43:55] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:43:55] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:43:55] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:43:55] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:43:55] xl.utils.env INFO: Using a generated random seed 55920979
[07/05 17:44:26] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:44:28] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:44:28] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:44:28] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:44:28] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:44:28] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:44:28] xl.utils.env INFO: Using a generated random seed 28094158
[07/05 17:46:50] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:46:51] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:46:51] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:46:51] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:46:51] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:46:51] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:46:51] xl.utils.env INFO: Using a generated random seed 52031591
[07/05 17:46:58] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 17:47:02] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 17:47:04] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 17:47:05] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:47:05] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:47:05] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:47:05] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:47:54] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:47:55] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:47:55] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:47:55] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:47:55] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:47:55] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:47:55] xl.utils.env INFO: Using a generated random seed 55810571
[07/05 17:48:27] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 17:48:27] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 17:48:29] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 17:48:29] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:48:29] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:48:29] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:48:29] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:48:58] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 17:48:58] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 17:49:57] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:49:58] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:49:58] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:49:58] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:49:58] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:49:58] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:49:58] xl.utils.env INFO: Using a generated random seed 58986147
[07/05 17:50:44] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 17:50:44] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 17:50:45] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 17:50:45] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:50:45] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:50:45] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:50:45] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:50:52] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 17:50:52] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 17:53:56] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 17:53:58] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 17:53:58] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 17:53:58] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 17:53:58] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 17:53:58] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 17:53:58] xl.utils.env INFO: Using a generated random seed 58187677
[07/05 17:54:02] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 17:54:02] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 17:54:04] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 17:54:04] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:54:04] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:54:04] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 17:54:04] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 17:54:11] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 17:54:11] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 18:04:13] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 18:04:14] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 18:04:14] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 18:04:14] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 18:04:14] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 18:04:14] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 18:04:14] xl.utils.env INFO: Using a generated random seed 14839561
[07/05 18:04:28] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 18:04:29] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 18:04:30] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 18:04:30] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:04:30] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:04:30] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:04:30] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:04:38] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 18:04:38] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 18:05:10] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 28, in run_step
    bs_outputs_dict = self.model(data, use_beam_search=False, output_sents=False)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 70, in forward
    batched_inputs = self.preprocess_batch(batched_inputs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 136, in preprocess_batch
    ids = np.expand_dims(batched_inputs[kfg.IDS], axis=1)
TypeError: list indices must be integers or slices, not str
[07/05 18:05:18] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 18:05:20] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 18:05:20] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 18:05:20] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 18:05:20] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 18:05:20] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 18:05:20] xl.utils.env INFO: Using a generated random seed 20243064
[07/05 18:05:24] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 18:05:24] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 18:05:25] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 18:05:25] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:05:25] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:05:25] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:05:25] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:05:32] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 18:05:32] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 18:07:43] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 18:07:45] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 18:07:45] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 18:07:45] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 18:07:45] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 18:07:45] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 18:07:45] xl.utils.env INFO: Using a generated random seed 45231279
[07/05 18:11:35] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 18:11:35] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 18:11:36] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 18:11:36] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:11:36] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:11:36] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 18:11:36] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 18:11:45] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 18:11:45] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 20:55:52] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 32, in run_step
    data[kfg.DECODE_BY_SAMPLE] = True
TypeError: list indices must be integers or slices, not str
[07/05 20:56:07] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 20:56:08] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 20:56:08] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 20:56:08] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 20:56:08] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 20:56:08] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 20:56:08] xl.utils.env INFO: Using a generated random seed 8537837
[07/05 20:58:24] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 20:58:24] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 20:58:26] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 20:58:26] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 20:58:26] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 20:58:26] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 20:58:26] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 20:58:35] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 20:58:35] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:10:08] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:10:09] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:10:09] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:10:09] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:10:09] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:10:09] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:10:09] xl.utils.env INFO: Using a generated random seed 9847949
[07/05 21:10:14] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:10:14] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:10:15] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:10:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:10:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:10:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:10:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:10:22] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:10:22] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:11:45] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 36, in run_step
    outputs_dict = self.model(data, use_beam_search=False, output_sents=False, use_preprocess=False)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 75, in forward
    return self.greedy_decode(batched_inputs, output_sents)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 155, in greedy_decode
    model=weakref.proxy(self)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decode_strategy/decode_strategy.py", line 35, in forward
    ret = self._forward(batched_inputs, model)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decode_strategy/greedy_decoder.py", line 20, in _forward
    ve_out = model.visual_embed(batched_inputs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/embedding/visual_embed.py", line 64, in forward
    embeddings = self.embeddings(feats)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: CUDA error: CUBLAS_STATUS_INVALID_VALUE when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
[07/05 21:11:45] xl.engine.hooks INFO: Total training time: 0:01:22 (0:00:00 on hooks)
[07/05 21:11:45] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 214M
[07/05 21:12:04] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:12:05] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:12:05] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:12:05] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:12:05] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:12:05] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:12:05] xl.utils.env INFO: Using a generated random seed 5670424
[07/05 21:12:09] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:12:10] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:12:12] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:12:12] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:12:12] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:12:12] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:12:12] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:12:21] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:12:21] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:13:02] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 36, in run_step
    outputs_dict = self.model(data, use_beam_search=False, output_sents=False, use_preprocess=False)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 75, in forward
    return self.greedy_decode(batched_inputs, output_sents)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 155, in greedy_decode
    model=weakref.proxy(self)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decode_strategy/decode_strategy.py", line 35, in forward
    ret = self._forward(batched_inputs, model)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decode_strategy/greedy_decoder.py", line 20, in _forward
    ve_out = model.visual_embed(batched_inputs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/embedding/visual_embed.py", line 64, in forward
    embeddings = self.embeddings(feats)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: CUDA error: CUBLAS_STATUS_INVALID_VALUE when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
[07/05 21:13:02] xl.engine.hooks INFO: Total training time: 0:00:41 (0:00:00 on hooks)
[07/05 21:13:02] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 214M
[07/05 21:13:09] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:13:10] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:13:10] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:13:10] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:13:10] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:13:10] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:13:10] xl.utils.env INFO: Using a generated random seed 10322440
[07/05 21:13:13] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:13:14] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:13:15] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:13:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:13:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:13:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:13:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:13:22] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:13:22] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:15:08] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:15:09] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:15:09] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:15:09] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:15:09] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:15:09] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:15:09] xl.utils.env INFO: Using a generated random seed 9341371
[07/05 21:15:36] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:15:36] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:15:38] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:15:38] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:15:38] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:15:38] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:15:38] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:15:55] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:15:55] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:23:34] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:23:35] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:23:35] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:23:35] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:23:35] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:23:35] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:23:35] xl.utils.env INFO: Using a generated random seed 35953285
[07/05 21:23:37] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:23:38] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:23:39] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:23:39] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:23:39] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:23:39] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:23:39] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:23:46] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:23:46] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:29:06] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:29:07] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:29:07] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:29:07] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:29:07] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:29:07] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:29:07] xl.utils.env INFO: Using a generated random seed 7734491
[07/05 21:29:09] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:29:10] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:29:11] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:29:11] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:29:11] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:29:11] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:29:11] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:29:18] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:29:18] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:31:07] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 38, in run_step
    rewards = rewards - bs_rewards
TypeError: unsupported operand type(s) for -: 'dict' and 'dict'
[07/05 21:31:09] xl.engine.hooks INFO: Total training time: 0:01:51 (0:00:00 on hooks)
[07/05 21:31:09] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 285M
[07/05 21:33:54] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:33:55] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:33:55] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:33:55] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:33:55] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:33:55] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:33:55] xl.utils.env INFO: Using a generated random seed 55513866
[07/05 21:33:57] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:33:57] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:33:59] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:33:59] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:33:59] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:33:59] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:33:59] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:34:06] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:34:06] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:46:37] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:46:39] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:46:39] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:46:39] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:46:39] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:46:39] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:46:39] xl.utils.env INFO: Using a generated random seed 39317312
[07/05 21:46:41] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:46:41] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:46:43] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:46:43] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:46:43] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:46:43] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:46:43] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:47:18] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 21:47:20] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 21:47:20] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 21:47:20] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 21:47:20] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 21:47:20] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 21:47:20] xl.utils.env INFO: Using a generated random seed 20487027
[07/05 21:47:22] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 21:47:22] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 21:47:24] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 21:47:24] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:47:24] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:47:24] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 21:47:24] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 21:47:31] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 21:47:31] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 21:58:21] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 45, in run_step
    loss_dict = loss(outputs_dict)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/losses/reward_criterion.py", line 24, in forward
    rewards = rewards.view(-1, 1).expand_as(logP)
ValueError: Type must be a sub-type of ndarray type
[07/05 21:58:23] xl.engine.hooks INFO: Total training time: 0:10:52 (0:00:00 on hooks)
[07/05 21:58:23] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 285M
[07/05 22:11:11] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 22:14:04] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 22:14:06] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 22:14:06] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 22:14:06] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 22:14:06] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 22:14:06] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 22:14:06] xl.utils.env INFO: Using a generated random seed 6186071
[07/05 22:14:08] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 22:14:08] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 22:14:09] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 22:14:10] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:14:10] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:14:10] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:14:10] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:14:17] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 22:14:17] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 22:17:55] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 22:17:57] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 22:17:57] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 22:17:57] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 22:17:57] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 22:17:57] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 22:17:57] xl.utils.env INFO: Using a generated random seed 57406914
[07/05 22:17:59] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 22:17:59] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 22:18:01] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 22:18:01] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:18:01] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:18:01] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:18:01] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:18:08] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 22:18:08] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 22:18:22] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/rl_trainer.py", line 54, in run_step
    self._write_metrics(loss_dict, data_time)
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 379, in _write_metrics
    metrics_dict = {k: v.detach().cpu().item() for k, v in loss_dict.items()}
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 379, in <dictcomp>
    metrics_dict = {k: v.detach().cpu().item() for k, v in loss_dict.items()}
AttributeError: 'numpy.float64' object has no attribute 'detach'
[07/05 22:22:22] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 22:22:24] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 22:22:24] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 22:22:24] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 22:22:24] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 22:22:24] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 22:22:24] xl.utils.env INFO: Using a generated random seed 24138000
[07/05 22:22:26] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 22:22:26] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 22:22:27] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 22:22:27] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:22:27] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:22:27] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:22:27] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:22:34] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 22:22:34] xl.engine.train_loop INFO: Starting training from iteration 0
[07/05 22:23:45] xmodaler INFO: Rank of current process: 0. World size: 1
[07/05 22:23:46] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/05 22:23:46] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/05 22:23:46] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/05 22:23:46] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/mscoco_open_source
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: RLTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: /export1/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/05 22:23:46] xmodaler INFO: Full config saved to ./output/config.yaml
[07/05 22:23:46] xl.utils.env INFO: Using a generated random seed 46884824
[07/05 22:23:48] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/05 22:23:49] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/05 22:23:50] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/05 22:23:50] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:23:50] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:23:50] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/05 22:23:50] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/05 22:23:57] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/05 22:23:57] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 02:27:33] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:27:35] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:27:35] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:27:35] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:27:35] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:27:35] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:27:35] xl.utils.env INFO: Using a generated random seed 35463026
[07/06 02:27:37] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:27:39] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:27:40] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:27:41] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:27:41] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:27:41] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:27:41] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:28:37] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:28:38] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:28:38] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:28:38] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:28:38] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:28:38] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:28:38] xl.utils.env INFO: Using a generated random seed 38620024
[07/06 02:28:40] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:28:40] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:28:42] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:28:42] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:28:42] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:28:42] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:28:42] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:29:09] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 02:29:09] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 02:29:48] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:29:49] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:29:49] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:29:49] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:29:49] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:29:49] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:29:49] xl.utils.env INFO: Using a generated random seed 49761544
[07/06 02:29:51] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:29:51] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:29:53] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:29:53] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:29:53] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:29:53] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:29:53] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:31:23] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 02:31:23] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 02:45:13] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:45:15] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:45:15] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:45:15] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:45:15] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:45:15] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:45:15] xl.utils.env INFO: Using a generated random seed 15403560
[07/06 02:45:16] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:45:17] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:45:19] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:45:19] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:45:19] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:45:19] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:45:19] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:45:22] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 02:45:22] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 02:48:48] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "d:\export\opensource\xmodaler\xmodaler\engine\train_loop.py", line 147, in train
    self.run_step()
  File "d:\export\opensource\xmodaler\xmodaler\engine\defaults.py", line 458, in run_step
    outputs_dict = self.model(data)
  File "C:\ProgramData\Anaconda3\lib\site-packages\torch\nn\modules\module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "d:\export\opensource\xmodaler\xmodaler\modeling\meta_arch\base_enc_dec.py", line 72, in forward
    return self._forward(batched_inputs)
  File "d:\export\opensource\xmodaler\xmodaler\modeling\meta_arch\rnn_att_enc_dec.py", line 60, in _forward
    wt.index_copy_(0, ind, torch.multinomial(prob_prev, 1).view(-1).index_select(0, ind))
RuntimeError: index_copy_(): self and source expected to have the same dtype, but got (self) Int and (source) Long
[07/06 02:48:51] xl.engine.hooks INFO: Overall training speed: 3 iterations in 0:00:34 (11.4385 s / it)
[07/06 02:48:51] xl.engine.hooks INFO: Total training time: 0:01:14 (0:00:40 on hooks)
[07/06 02:48:51] xl.utils.events INFO:  eta: 3 days, 16:40:46  iter: 5  total_loss: 6.859  time: 4.0570  data_time: 0.0171  lr: 0.0005  max_mem: 1304M
[07/06 02:58:06] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:58:08] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:58:08] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:58:08] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:58:08] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:58:08] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:58:08] xl.utils.env INFO: Using a generated random seed 8273854
[07/06 02:58:09] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:58:10] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:58:12] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:58:12] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:58:12] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:58:12] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:58:12] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:58:14] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 02:58:14] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 02:58:42] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 02:58:44] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 02:58:44] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 02:58:44] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 02:58:44] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 02:58:44] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 02:58:44] xl.utils.env INFO: Using a generated random seed 44249407
[07/06 02:58:45] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 02:58:46] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 02:58:47] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 02:58:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:58:48] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:58:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 02:58:48] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 02:58:59] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 02:58:59] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 03:10:09] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 03:10:11] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 03:10:11] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 03:10:11] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 03:10:11] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 03:10:11] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 03:10:11] xl.utils.env INFO: Using a generated random seed 11255945
[07/06 03:10:12] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 03:10:13] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 03:10:14] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 03:10:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 03:10:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 03:10:15] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 03:10:15] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 03:10:17] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 03:10:17] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 03:13:42] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 03:13:44] xmodaler INFO: Environment info:
----------------------  -----------------------------------------------------------------------------------------
sys.platform            win32
Python                  3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
numpy                   1.19.2
detectron2              0.3 @d:\export\net\imagenet\detectron2\detectron2
Compiler                MSVC 191627045
CUDA compiler           CUDA 11.1
detectron2 arch flags   d:\export\net\imagenet\detectron2\detectron2\_C.cp38-win_amd64.pyd; cannot find cuobjdump
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0 @C:\ProgramData\Anaconda3\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce RTX 2060 (arch=7.5)
CUDA_HOME               C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1
Pillow                  8.0.1
torchvision             0.10.0 @C:\ProgramData\Anaconda3\lib\site-packages\torchvision
torchvision arch flags  C:\ProgramData\Anaconda3\lib\site-packages\torchvision\_C.pyd; cannot find cuobjdump
fvcore                  0.1.3.post20210317
iopath                  0.1.8
cv2                     Not found
----------------------  -----------------------------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 2019
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=C:/cb/pytorch_1000000000000/work/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/cb/pytorch_1000000000000/work/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, 

[07/06 03:13:44] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 03:13:44] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 03:13:44] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: D:/export/dataset/mscoco_open_source
  FEATS_FOLDER: D:/export/dataset/mscoco_open_source/features/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: D:/export/dataset/mscoco_open_source/captions_test5k.json
  VAL_ANNFILE: D:/export/dataset/mscoco_open_source/captions_val5k.json
  VOCAB: D:/export/dataset/mscoco_open_source/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 03:13:44] xmodaler INFO: Full config saved to ./output\config.yaml
[07/06 03:13:44] xl.utils.env INFO: Using a generated random seed 44337268
[07/06 03:13:45] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 03:13:46] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 03:13:48] xl.datasets.common INFO: Serialized dataset takes 172.81 MiB
[07/06 03:13:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 03:13:48] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 03:13:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 03:13:48] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 03:13:53] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 03:13:53] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:45:43] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:45:45] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:45:45] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:45:45] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:45:45] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:45:45] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:45:45] xl.utils.env INFO: Using a generated random seed 45575045
[07/06 20:45:48] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:45:54] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:45:55] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:45:55] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:45:55] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:45:55] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:45:55] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:45:55] xl.utils.env INFO: Using a generated random seed 56021655
[07/06 20:47:07] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:47:09] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:47:10] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:47:18] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:47:18] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:47:19] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:47:19] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:47:49] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:49:22] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:49:41] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 450, in run_step
    data = next(self._train_data_loader_iter)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/export1/open_source/xmodaler/xmodaler/datasets/common.py", line 41, in __getitem__
    data = self._map_func(self._dataset[cur_idx])
  File "/export1/open_source/xmodaler/xmodaler/utils/serialize.py", line 23, in __call__
    return self._obj(*args, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/datasets/videos/msvd.py", line 66, in __call__
    content = read_np(feat_path)
  File "/export1/open_source/xmodaler/xmodaler/functional/func_io.py", line 16, in read_np
    content = np.load(image_path)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/numpy/lib/npyio.py", line 416, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: '/export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch/100001.npy'
[07/06 20:50:03] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:50:04] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:50:04] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:50:04] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:50:04] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:50:04] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:50:04] xl.utils.env INFO: Using a generated random seed 4908524
[07/06 20:50:08] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:50:08] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:50:09] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:50:09] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:50:09] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:50:09] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:50:09] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:50:11] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:50:11] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:50:35] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:50:37] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:50:37] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:50:37] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:50:37] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:50:37] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:50:37] xl.utils.env INFO: Using a generated random seed 37272521
[07/06 20:50:40] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:50:40] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:50:41] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:50:41] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:50:41] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:50:41] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:50:41] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:50:43] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:50:43] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:51:02] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:51:03] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:51:03] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:51:03] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:51:03] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:51:03] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:51:03] xl.utils.env INFO: Using a generated random seed 3463110
[07/06 20:51:10] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:51:11] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:51:12] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:51:13] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:51:13] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:51:14] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:51:14] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:51:16] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:51:16] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:51:23] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 450, in run_step
    data = next(self._train_data_loader_iter)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/export1/open_source/xmodaler/xmodaler/datasets/common.py", line 41, in __getitem__
    data = self._map_func(self._dataset[cur_idx])
  File "/export1/open_source/xmodaler/xmodaler/utils/serialize.py", line 23, in __call__
    return self._obj(*args, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/datasets/videos/msvd.py", line 66, in __call__
    content = read_np(feat_path)
  File "/export1/open_source/xmodaler/xmodaler/functional/func_io.py", line 17, in read_np
    keys = content.keys()
AttributeError: 'numpy.ndarray' object has no attribute 'keys'
[07/06 20:51:24] xl.engine.hooks INFO: Total training time: 0:00:07 (0:00:00 on hooks)
[07/06 20:51:24] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 65M
[07/06 20:51:35] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:51:36] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:51:36] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:51:36] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:51:36] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:51:36] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:51:36] xl.utils.env INFO: Using a generated random seed 36808542
[07/06 20:51:40] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:51:40] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:51:40] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:51:40] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:51:40] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:51:40] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:51:41] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:51:43] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:51:43] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:52:49] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:52:51] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:52:51] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:52:51] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:52:51] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:52:51] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:52:51] xl.utils.env INFO: Using a generated random seed 51266090
[07/06 20:52:54] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:52:54] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:52:55] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:52:55] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:52:55] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:52:55] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:52:55] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:52:57] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:52:57] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:53:08] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 450, in run_step
    data = next(self._train_data_loader_iter)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/export1/open_source/xmodaler/xmodaler/datasets/common.py", line 41, in __getitem__
    data = self._map_func(self._dataset[cur_idx])
  File "/export1/open_source/xmodaler/xmodaler/utils/serialize.py", line 23, in __call__
    return self._obj(*args, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/datasets/videos/msvd.py", line 66, in __call__
    content = read_np(feat_path)
  File "/export1/open_source/xmodaler/xmodaler/functional/func_io.py", line 17, in read_np
    if isinstance(content, np.array):
TypeError: isinstance() arg 2 must be a type or tuple of types
[07/06 20:53:08] xl.engine.hooks INFO: Total training time: 0:00:10 (0:00:00 on hooks)
[07/06 20:53:08] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 65M
[07/06 20:54:24] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:54:26] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:54:26] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:54:26] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:54:26] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:54:26] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:54:26] xl.utils.env INFO: Using a generated random seed 26217370
[07/06 20:54:28] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:54:32] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:54:32] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 20:54:32] xl.datasets.common INFO: Serializing 4172 elements to byte tensors and concatenating them all ...
[07/06 20:54:32] xl.datasets.common INFO: Serialized dataset takes 1.70 MiB
[07/06 20:54:32] xl.datasets.common INFO: Serializing 27735 elements to byte tensors and concatenating them all ...
[07/06 20:54:33] xl.datasets.common INFO: Serialized dataset takes 11.29 MiB
[07/06 20:54:35] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 20:54:35] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 20:55:46] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 20:55:47] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 20:55:47] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 20:55:47] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 20:55:47] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 17
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 20:55:47] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 20:55:47] xl.utils.env INFO: Using a generated random seed 47756210
[07/06 20:55:51] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 20:56:15] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 20:56:15] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 21:33:42] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:33:43] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:33:43] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:33:43] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 21:33:43] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/mscoco
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/mscoco/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/open_source/mscoco/captions_val5k.json
  VOCAB: /export1/dataset/open_source/mscoco/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:33:43] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:33:43] xl.utils.env INFO: Using a generated random seed 43438143
[07/06 21:33:47] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:33:47] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 21:33:48] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/06 21:33:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:33:48] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:33:48] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:33:49] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:33:51] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 21:33:51] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 21:34:15] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:34:16] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:34:16] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:34:16] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 21:34:16] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/mscoco
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 5
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/mscoco/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/open_source/mscoco/captions_val5k.json
  VOCAB: /export1/dataset/open_source/mscoco/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:34:16] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:34:16] xl.utils.env INFO: Using a generated random seed 16813676
[07/06 21:34:44] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:35:11] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 21:35:13] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/06 21:35:13] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:35:13] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:35:13] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:35:13] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:35:15] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 21:35:15] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 21:35:42] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:35:43] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:35:43] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:35:43] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 21:35:43] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/mscoco
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 10
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/mscoco/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/open_source/mscoco/captions_val5k.json
  VOCAB: /export1/dataset/open_source/mscoco/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:35:43] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:35:43] xl.utils.env INFO: Using a generated random seed 43862236
[07/06 21:35:47] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:35:47] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 21:35:49] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/06 21:35:49] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:35:49] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:35:49] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:35:49] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:35:51] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 21:35:51] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 21:36:00] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 450, in run_step
    data = next(self._train_data_loader_iter)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/export1/open_source/xmodaler/xmodaler/datasets/common.py", line 41, in __getitem__
    data = self._map_func(self._dataset[cur_idx])
  File "/export1/open_source/xmodaler/xmodaler/utils/serialize.py", line 23, in __call__
    return self._obj(*args, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/datasets/images/mscoco.py", line 92, in __call__
    selects = random.choice(range(sent_num), self.seq_per_img - sent_num)
TypeError: choice() takes 2 positional arguments but 3 were given
[07/06 21:36:00] xl.engine.hooks INFO: Total training time: 0:00:09 (0:00:00 on hooks)
[07/06 21:36:00] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 198M
[07/06 21:37:21] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:37:22] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:37:22] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/image_caption/updown.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:37:22] xmodaler INFO: Contents of args.config_file=./configs/image_caption/updown.yaml:
_BASE_: "base_att_image_caption.yaml"

MODEL:
  UPDOWN:
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
    ATT_EMBED_DROPOUT: 0.1

[07/06 21:37:22] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/mscoco
  FEATS_FOLDER: /export1/dataset/mscoco_torch/feature/up_down_100
  MAX_FEAT_NUM: 50
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 10
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSCoCoDataset
  TRAIN: MSCoCoDataset
  VAL: MSCoCoDataset
DECODE_STRATEGY:
  BEAM_SIZE: 3
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/mscoco/captions_test5k.json
  VAL_ANNFILE: /export1/dataset/open_source/mscoco/captions_val5k.json
  VOCAB: /export1/dataset/open_source/mscoco/coco_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['LabelSmoothing']
LR_SCHEDULER:
  GAMMA: 0.1
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: UpDownDecoder
  DECODER_DIM: 1000
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1000
  MAX_SEQ_LEN: 20
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: relu
    DIM: 1000
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  UPDOWN:
    ATT_EMBED_DROPOUT: 0.1
    ATT_EMBED_SIZE: 512
    DROPOUT1: 0.1
    DROPOUT2: 0.1
  VISUAL_EMBED:
    ACTIVATION: relu
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1000
    USE_NORM: False
  VOCAB_SIZE: 10200
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: /export1/dataset/mscoco_open_source/mscoco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: /export1/dataset/mscoco_open_source/mscoco_train_gts.pkl
  NAME: BaseScorer
  TYPES: ['Cider']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 10
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.1
  GRAD_CLIP_TYPE: value
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:37:22] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:37:22] xl.utils.env INFO: Using a generated random seed 22576756
[07/06 21:38:21] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(10200, 1000)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1000, bias=True)
    (embeddings_act): ReLU()
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): UpDownDecoder(
    (lstm1): LSTMCell(3000, 1000)
    (dropout1): Dropout(p=0.1, inplace=False)
    (lstm2): LSTMCell(2000, 1000)
    (dropout2): Dropout(p=0.1, inplace=False)
    (att): BaseAttention(
      (w_h): Linear(in_features=1000, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (dropout): Dropout(p=0.1, inplace=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1000, out_features=512, bias=True)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1000, out_features=10200, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:38:21] xl.datasets.common INFO: Serializing 113287 elements to byte tensors and concatenating them all ...
[07/06 21:38:23] xl.datasets.common INFO: Serialized dataset takes 115.74 MiB
[07/06 21:38:23] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:38:23] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:38:23] xl.datasets.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[07/06 21:38:23] xl.datasets.common INFO: Serialized dataset takes 0.17 MiB
[07/06 21:38:25] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 21:38:25] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 21:51:47] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:51:48] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:51:48] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:51:48] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 21:51:48] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:51:48] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:51:48] xl.utils.env INFO: Using a generated random seed 49043240
[07/06 21:51:58] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:51:59] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:51:59] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:51:59] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 21:51:59] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:51:59] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:51:59] xl.utils.env INFO: Using a generated random seed 59977829
[07/06 21:52:03] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:52:50] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 21:52:51] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 21:52:51] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 21:52:51] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 21:52:51] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 21:52:51] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 21:52:51] xl.utils.env INFO: Using a generated random seed 51468911
[07/06 21:52:55] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 21:53:05] xl.datasets.common INFO: Serializing 1200 elements to byte tensors and concatenating them all ...
[07/06 21:53:05] xl.datasets.common INFO: Serialized dataset takes 8.11 MiB
[07/06 22:06:06] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:06:08] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:06:08] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:06:08] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:06:08] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:06:08] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:06:08] xl.utils.env INFO: Using a generated random seed 8166687
[07/06 22:06:11] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:08:39] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:08:40] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:08:40] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:08:40] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:08:40] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:08:40] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:08:40] xl.utils.env INFO: Using a generated random seed 41015193
[07/06 22:09:30] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:11:16] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:11:17] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:11:17] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:11:17] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:11:18] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:11:18] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:11:18] xl.utils.env INFO: Using a generated random seed 18080284
[07/06 22:11:22] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:11:43] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:11:43] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 22:11:43] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:11:43] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:11:43] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:11:43] xl.datasets.common INFO: Serialized dataset takes 4.61 MiB
[07/06 22:11:45] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:11:45] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:15:24] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 458, in run_step
    outputs_dict = self.model(data)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 72, in forward
    return self._forward(batched_inputs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/rnn_att_enc_dec.py", line 40, in _forward
    inputs = self.decoder.preprocess(inputs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decoder/mplstm_decoder.py", line 41, in preprocess
    (init_states[kfg.G_HIDDEN_STATES][0], init_states[kfg.G_CELL_STATES][0]))
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 1058, in forward
    self.bias_ih, self.bias_hh,
RuntimeError: input has inconsistent input_size: got 1024 expected 512
[07/06 22:15:24] xl.engine.hooks INFO: Total training time: 0:03:39 (0:00:00 on hooks)
[07/06 22:15:24] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 68M
[07/06 22:15:30] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:15:32] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:15:32] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:15:32] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:15:32] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 512
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:15:32] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:15:32] xl.utils.env INFO: Using a generated random seed 32599781
[07/06 22:15:38] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 512)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(512, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:15:39] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:15:40] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 22:15:40] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:15:40] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:15:40] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:15:40] xl.datasets.common INFO: Serialized dataset takes 4.61 MiB
[07/06 22:15:42] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:15:42] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:16:57] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:16:59] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:16:59] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:16:59] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:16:59] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:16:59] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:16:59] xl.utils.env INFO: Using a generated random seed 59215573
[07/06 22:17:09] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(1024, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:17:10] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:17:11] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 22:17:11] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:17:11] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:17:11] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:17:11] xl.datasets.common INFO: Serialized dataset takes 4.61 MiB
[07/06 22:17:13] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:17:13] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:19:13] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 458, in run_step
    outputs_dict = self.model(data)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 72, in forward
    return self._forward(batched_inputs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/rnn_att_enc_dec.py", line 71, in _forward
    decoder_out = self.decoder(inputs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decoder/mplstm_decoder.py", line 50, in forward
    xt = batched_inputs[kfg.TOKEN_EMBED]
  File "/home/v-yehl/.local/lib/python3.6/site-packages/yacs/config.py", line 141, in __getattr__
    raise AttributeError(name)
AttributeError: TOKEN_EMBED
[07/06 22:19:13] xl.engine.hooks INFO: Total training time: 0:01:59 (0:00:00 on hooks)
[07/06 22:19:13] xl.utils.events INFO:  iter: 0    lr: N/A  max_mem: 91M
[07/06 22:19:38] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:19:39] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:19:39] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/mplstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:19:39] xmodaler INFO: Contents of args.config_file=./configs/video_caption/mplstm.yaml:
_BASE_: "base_att_msvd_caption.yaml"

MODEL:
  DECODER: 'MPLSTMDecoder'
  PREDICTOR: 'BasePredictor'
  


[07/06 22:19:39] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: MPLSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:19:39] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:19:39] xl.utils.env INFO: Using a generated random seed 39377562
[07/06 22:19:43] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): MPLSTMDecoder(
    (lstm): LSTMCell(1024, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:19:44] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:19:44] xl.datasets.common INFO: Serialized dataset takes 19.84 MiB
[07/06 22:19:44] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:19:44] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:19:44] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:19:44] xl.datasets.common INFO: Serialized dataset takes 4.61 MiB
[07/06 22:19:47] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:19:47] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:45:35] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:45:36] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:45:36] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/msvd/salstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:45:36] xmodaler INFO: Contents of args.config_file=./configs/video_caption/msvd/salstm.yaml:
_BASE_: "base_caption.yaml"

MODEL: 
  SALSTM:
    ATT_EMBED_SIZE: 512
    ATT_EMBED_DROPOUT: 0.0
  


[07/06 22:45:36] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: SALSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: UpDownEncoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  SALSTM:
    ATT_EMBED_DROPOUT: 0.0
    ATT_EMBED_SIZE: 512
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:45:36] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:45:36] xl.utils.env INFO: Using a generated random seed 36912185
[07/06 22:46:20] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): UpDownEncoder()
  (decoder): SALSTMDecoder(
    (att): BaseAttention(
      (w_h): Linear(in_features=1024, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1024, out_features=512, bias=True)
    (lstm): LSTMCell(2048, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:46:21] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:46:21] xl.datasets.common INFO: Serialized dataset takes 19.99 MiB
[07/06 22:46:21] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:46:21] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:46:21] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:46:21] xl.datasets.common INFO: Serialized dataset takes 4.62 MiB
[07/06 22:46:23] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:46:23] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:47:06] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:47:07] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:47:07] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/msvd/salstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:47:07] xmodaler INFO: Contents of args.config_file=./configs/video_caption/msvd/salstm.yaml:
_BASE_: "base_caption.yaml"

MODEL: 
  ENCODER: 'Encoder'
  SALSTM:
    ATT_EMBED_SIZE: 512
    ATT_EMBED_DROPOUT: 0.0
  


[07/06 22:47:07] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: SALSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: Encoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  SALSTM:
    ATT_EMBED_DROPOUT: 0.0
    ATT_EMBED_SIZE: 512
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:47:07] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:47:07] xl.utils.env INFO: Using a generated random seed 7849800
[07/06 22:47:32] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): Encoder()
  (decoder): SALSTMDecoder(
    (att): BaseAttention(
      (w_h): Linear(in_features=1024, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1024, out_features=512, bias=True)
    (lstm): LSTMCell(2048, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:47:32] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:47:33] xl.datasets.common INFO: Serialized dataset takes 19.99 MiB
[07/06 22:47:33] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:47:33] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:47:33] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:47:33] xl.datasets.common INFO: Serialized dataset takes 4.62 MiB
[07/06 22:47:35] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:47:35] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 22:49:17] xl.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/export1/open_source/xmodaler/xmodaler/engine/train_loop.py", line 147, in train
    self.run_step()
  File "/export1/open_source/xmodaler/xmodaler/engine/defaults.py", line 458, in run_step
    outputs_dict = self.model(data)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/base_enc_dec.py", line 72, in forward
    return self._forward(batched_inputs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/meta_arch/rnn_att_enc_dec.py", line 71, in _forward
    decoder_out = self.decoder(inputs)
  File "/home/v-yehl/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/export1/open_source/xmodaler/xmodaler/modeling/decoder/salstm_decoder.py", line 78, in forward
    kfg.HIDDEN_STATES: [hidden_state],
  File "/home/v-yehl/.local/lib/python3.6/site-packages/yacs/config.py", line 141, in __getattr__
    raise AttributeError(name)
AttributeError: HIDDEN_STATES
[07/06 22:49:33] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 22:49:34] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 22:49:34] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/msvd/salstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 22:49:34] xmodaler INFO: Contents of args.config_file=./configs/video_caption/msvd/salstm.yaml:
_BASE_: "base_caption.yaml"

MODEL: 
  ENCODER: 'Encoder'
  SALSTM:
    ATT_EMBED_SIZE: 512
    ATT_EMBED_DROPOUT: 0.0
  


[07/06 22:49:34] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msvd_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msvd_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSVDDataset
  TRAIN: MSVDDataset
  VAL: MSVDDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msvd_dataset/test_cocostyle.json
  VAL_ANNFILE: /export1/dataset/open_source/msvd_dataset/val_cocostyle.json
  VOCAB: /export1/dataset/open_source/msvd_dataset/msvd_vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: SALSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: Encoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  SALSTM:
    ATT_EMBED_DROPOUT: 0.0
    ATT_EMBED_SIZE: 512
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 22:49:34] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 22:49:34] xl.utils.env INFO: Using a generated random seed 34698195
[07/06 22:49:56] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): Encoder()
  (decoder): SALSTMDecoder(
    (att): BaseAttention(
      (w_h): Linear(in_features=1024, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1024, out_features=512, bias=True)
    (lstm): LSTMCell(2048, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 22:49:57] xl.datasets.common INFO: Serializing 48748 elements to byte tensors and concatenating them all ...
[07/06 22:49:58] xl.datasets.common INFO: Serialized dataset takes 19.99 MiB
[07/06 22:49:58] xl.datasets.common INFO: Serializing 97 elements to byte tensors and concatenating them all ...
[07/06 22:49:58] xl.datasets.common INFO: Serialized dataset takes 0.69 MiB
[07/06 22:49:58] xl.datasets.common INFO: Serializing 670 elements to byte tensors and concatenating them all ...
[07/06 22:49:58] xl.datasets.common INFO: Serialized dataset takes 4.62 MiB
[07/06 22:50:00] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 22:50:00] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 23:23:43] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 23:23:45] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 23:23:45] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/msrvtt/salstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 23:23:45] xmodaler INFO: Contents of args.config_file=./configs/video_caption/msrvtt/salstm.yaml:
_BASE_: "base_caption.yaml"

MODEL: 
  ENCODER: 'Encoder'
  SALSTM:
    ATT_EMBED_SIZE: 512
    ATT_EMBED_DROPOUT: 0.0
  


[07/06 23:23:45] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msrvtt_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msrvtt_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSRVTTDataset
  TRAIN: MSRVTTDataset
  VAL: MSRVTTDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msrvtt_dataset/captions_test.json
  VAL_ANNFILE: /export1/dataset/open_source/msrvtt_dataset/captions_val.json
  VOCAB: /export1/dataset/open_source/msrvtt_dataset/vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: SALSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: Encoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  SALSTM:
    ATT_EMBED_DROPOUT: 0.0
    ATT_EMBED_SIZE: 512
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 5492
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 23:23:45] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 23:23:45] xl.utils.env INFO: Using a generated random seed 45169412
[07/06 23:23:48] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(5492, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): Encoder()
  (decoder): SALSTMDecoder(
    (att): BaseAttention(
      (w_h): Linear(in_features=1024, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1024, out_features=512, bias=True)
    (lstm): LSTMCell(2048, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=5492, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 23:24:16] xl.datasets.common INFO: Serializing 130260 elements to byte tensors and concatenating them all ...
[07/06 23:24:18] xl.datasets.common INFO: Serialized dataset takes 53.52 MiB
[07/06 23:24:18] xl.datasets.common INFO: Serializing 497 elements to byte tensors and concatenating them all ...
[07/06 23:24:18] xl.datasets.common INFO: Serialized dataset takes 1.72 MiB
[07/06 23:24:18] xl.datasets.common INFO: Serializing 2990 elements to byte tensors and concatenating them all ...
[07/06 23:24:18] xl.datasets.common INFO: Serialized dataset takes 10.35 MiB
[07/06 23:24:20] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 23:24:20] xl.engine.train_loop INFO: Starting training from iteration 0
[07/06 23:57:50] xmodaler INFO: Rank of current process: 0. World size: 1
[07/06 23:57:51] xmodaler INFO: Environment info:
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]
numpy                   1.19.4
detectron2              0.3 @/export1/net/imagenet/detectron2/detectron2
detectron2._C           not built correctly: /export1/net/imagenet/detectron2/detectron2/_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZNK2at6Tensor6deviceEv
Compiler ($CXX)         c++ (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
CUDA compiler           Build cuda_11.1.TC455_06.29069683_0
detectron2 arch flags   6.1
DETECTRON2_ENV_MODULE   <not set>
PyTorch                 1.9.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0                   GeForce GTX 1070 (arch=6.1)
CUDA_HOME               /usr/local/cuda
Pillow                  8.0.1
torchvision             0.10.0+cu111 @/home/v-yehl/.local/lib/python3.6/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.3.post20210204
iopath                  0.1.3
cv2                     4.4.0
----------------------  ----------------------------------------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.1
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[07/06 23:57:51] xmodaler INFO: Command line arguments: Namespace(config_file='./configs/video_caption/msrvtt/salstm.yaml', dist_url='tcp://127.0.0.1:50152', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[07/06 23:57:51] xmodaler INFO: Contents of args.config_file=./configs/video_caption/msrvtt/salstm.yaml:
_BASE_: "base_caption.yaml"

MODEL: 
  ENCODER: 'Encoder'
  SALSTM:
    ATT_EMBED_SIZE: 512
    ATT_EMBED_DROPOUT: 0.0
  


[07/06 23:57:51] xmodaler INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  ANNO_FOLDER: /export1/dataset/open_source/msrvtt_dataset
  FEATS_FOLDER: /export1/dataset/open_source/msrvtt_dataset/feat_resnet152_imagenet_pytorch
  MAX_FEAT_NUM: 25
  NUM_WORKERS: 0
  SEQ_PER_SAMPLE: 1
  TEST_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
DATASETS:
  TEST: MSRVTTDataset
  TRAIN: MSRVTTDataset
  VAL: MSRVTTDataset
DECODE_STRATEGY:
  BEAM_SIZE: 5
  NAME: BeamSearcher
ENGINE:
  NAME: DefaultTrainer
INFERENCE:
  CAP_KEY: caption
  ID_KEY: image_id
  NAME: COCOEvaler
  TEST_ANNFILE: /export1/dataset/open_source/msrvtt_dataset/captions_test.json
  VAL_ANNFILE: /export1/dataset/open_source/msrvtt_dataset/captions_val.json
  VOCAB: /export1/dataset/open_source/msrvtt_dataset/vocabulary.txt
LOSSES:
  LABELSMOOTHING: 0.1
  NAMES: ['CrossEntropy']
LR_SCHEDULER:
  GAMMA: 0.8
  NAME: StepLR
  STEP_SIZE: 3
MODEL:
  BERT:
    ATTENTION_PROBS_DROPOUT_PROB: 0.1
    FFN_DROPOUT_PROB: 0.1
    HIDDEN_ACT: gelu
    HIDDEN_DROPOUT_PROB: 0.1
    HIDDEN_SIZE: 512
    INTERMEDIATE_DROP: 0.1
    INTERMEDIATE_SIZE: 2048
    NUM_ATTENTION_HEADS: 8
    NUM_GENERATION_LAYERS: 6
    NUM_HIDDEN_LAYERS: 12
    NUM_UNDERSTANDING_LAYERS: 6
    V_NUM_HIDDEN_LAYERS: 6
    V_TARGET_SIZE: 1600
  DECODER: SALSTMDecoder
  DECODER_DIM: 1024
  DEVICE: cuda
  ENCODER: Encoder
  ENCODER_DIM: 1024
  MAX_SEQ_LEN: 21
  META_ARCHITECTURE: RnnAttEncoderDecoder
  PREDICTOR: BasePredictor
  PRED_DROPOUT: 0.5
  PRETRAINING:
    DO_LOWER_CASE: True
    FROM_PRETRAINED: bert-base-uncased
    MODEL_NAME: bert-base-uncased
  SALSTM:
    ATT_EMBED_DROPOUT: 0.0
    ATT_EMBED_SIZE: 512
  TOKEN_EMBED:
    ACTIVATION: none
    DIM: 1024
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    NAME: TokenBaseEmbedding
    POSITION: none
    POSITION_MAX_LEN: 5000
    TYPE_VOCAB_SIZE: 0
    USE_NORM: False
  VISUAL_EMBED:
    ACTIVATION: none
    DROPOUT: 0.5
    ELU_ALPHA: 0.5
    IN_DIM: 2048
    LOCATION_SIZE: 0
    NAME: VisualBaseEmbedding
    OUT_DIM: 1024
    USE_NORM: False
  VOCAB_SIZE: 7001
  V_PREDICTOR: 
  WEIGHTS: 
OUTPUT_DIR: ./output
SCHEDULED_SAMPLING:
  INC_EVERY_EPOCH: 5
  INC_PROB: 0.05
  MAX_PROB: 0.25
  START_EPOCH: 0
SCORER:
  CIDER_CACHED: coco_train_cider.pkl
  EOS_ID: 0
  GT_PATH: coco_train_gts.pkl
  NAME: 
  TYPES: ['']
  WEIGHTS: [1.0]
SEED: -1
SOLVER:
  AMSGRAD: False
  BASE_LR: 0.0005
  BETAS: [0.9, 0.98]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DAMPENING: 0.0
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 1
  GRAD_CLIP: 0.5
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.0
  NAME: Adam
  NESTEROV: 0.0
  NORM_TYPE: 2.0
  WEIGHT_DECAY: 0.0
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_NORM: 0.0
VERSION: 1
[07/06 23:57:51] xmodaler INFO: Full config saved to ./output/config.yaml
[07/06 23:57:51] xl.utils.env INFO: Using a generated random seed 52071800
[07/06 23:57:55] xl.engine.defaults INFO: Model:
RnnAttEncoderDecoder(
  (token_embed): TokenBaseEmbedding(
    (embeddings): Embedding(7001, 1024)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (visual_embed): VisualBaseEmbedding(
    (embeddings): Linear(in_features=2048, out_features=1024, bias=True)
    (embeddings_dropout): Dropout(p=0.5, inplace=False)
  )
  (encoder): Encoder()
  (decoder): SALSTMDecoder(
    (att): BaseAttention(
      (w_h): Linear(in_features=1024, out_features=512, bias=False)
      (act): Tanh()
      (w_alpha): Linear(in_features=512, out_features=1, bias=False)
      (softmax): Softmax(dim=-1)
    )
    (p_att_feats): Linear(in_features=1024, out_features=512, bias=True)
    (lstm): LSTMCell(2048, 1024)
  )
  (predictor): BasePredictor(
    (logits): Linear(in_features=1024, out_features=7001, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (greedy_decoder): GreedyDecoder()
  (beam_searcher): BeamSearcher()
)
[07/06 23:57:59] xl.datasets.common INFO: Serializing 130260 elements to byte tensors and concatenating them all ...
[07/06 23:58:00] xl.datasets.common INFO: Serialized dataset takes 53.52 MiB
[07/06 23:58:00] xl.datasets.common INFO: Serializing 497 elements to byte tensors and concatenating them all ...
[07/06 23:58:00] xl.datasets.common INFO: Serialized dataset takes 1.72 MiB
[07/06 23:58:00] xl.datasets.common INFO: Serializing 2990 elements to byte tensors and concatenating them all ...
[07/06 23:58:00] xl.datasets.common INFO: Serialized dataset takes 10.35 MiB
[07/06 23:58:02] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/06 23:58:02] xl.engine.train_loop INFO: Starting training from iteration 0
