

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>xmodaler.engine &mdash; Xmodaler 1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="xmodaler.evaluation" href="evaluation.html" />
    <link rel="prev" title="xmodaler.datasets" href="datasets.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Xmodaler
          

          
          </a>

          
            
            
              <div class="version">
                v 1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/index.html">Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="checkpoint.html">xmodaler.checkpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">xmodaler.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html">xmodaler.datasets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">xmodaler.engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation.html">xmodaler.evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html">xmodaler.functional</a></li>
<li class="toctree-l2"><a class="reference internal" href="losses.html">xmodaler.losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="lr_scheduler.html">xmodaler.lr_scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling/index.html">xmodaler.modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="optim.html">xmodaler.optim</a></li>
<li class="toctree-l2"><a class="reference internal" href="scorer.html">xmodaler.scorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="tokenization.html">xmodaler.tokenization</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">xmodaler.utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Xmodaler</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Documentation</a> &raquo;</li>
        
      <li>xmodaler.engine</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/YehLi/xmodaler/blob/master/docs/modules/engine.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="xmodaler-engine">
<h1>xmodaler.engine<a class="headerlink" href="#xmodaler-engine" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="xmodaler.engine.launch">
<code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">launch</code><span class="sig-paren">(</span><em class="sig-param">main_func</em>, <em class="sig-param">num_gpus_per_machine</em>, <em class="sig-param">num_machines=1</em>, <em class="sig-param">machine_rank=0</em>, <em class="sig-param">dist_url=None</em>, <em class="sig-param">args=()</em>, <em class="sig-param">timeout=datetime.timedelta(seconds=1800)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/launch.html#launch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.launch" title="Permalink to this definition">¶</a></dt>
<dd><p>Launch multi-gpu or distributed training.
This function must be called on all machines involved in the training.
It will spawn child processes (defined by <code class="docutils literal notranslate"><span class="pre">num_gpus_per_machine</span></code>) on each machine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_func</strong> – a function that will be called by <cite>main_func(*args)</cite></p></li>
<li><p><strong>num_gpus_per_machine</strong> (<em>int</em>) – number of GPUs per machine</p></li>
<li><p><strong>num_machines</strong> (<em>int</em>) – the total number of machines</p></li>
<li><p><strong>machine_rank</strong> (<em>int</em>) – the rank of this machine</p></li>
<li><p><strong>dist_url</strong> (<em>str</em>) – url to connect to for distributed jobs, including protocol
e.g. “<a class="reference external" href="tcp://127.0.0.1:8686">tcp://127.0.0.1:8686</a>”.
Can be set to “auto” to automatically select a free port on localhost</p></li>
<li><p><strong>timeout</strong> (<em>timedelta</em>) – timeout of the distributed workers</p></li>
<li><p><strong>args</strong> (<em>tuple</em>) – arguments passed to main_func</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="xmodaler.engine.build_engine">
<code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">build_engine</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/build.html#build_engine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.build_engine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="xmodaler.engine.default_argument_parser">
<code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">default_argument_parser</code><span class="sig-paren">(</span><em class="sig-param">epilog=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#default_argument_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.default_argument_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a parser with some common arguments used by X-modaler users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>epilog</strong> (<em>str</em>) – epilog passed to ArgumentParser describing the usage.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>argparse.ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="xmodaler.engine.default_setup">
<code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">default_setup</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#default_setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.default_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform some basic common setups at the beginning of a job, including:</p>
<ol class="arabic simple">
<li><p>Set up the X-modaler logger</p></li>
<li><p>Log basic information about environment, cmdline arguments, and config</p></li>
<li><p>Backup the config to the output directory</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<a class="reference internal" href="config.html#xmodaler.config.CfgNode" title="xmodaler.config.CfgNode"><em>CfgNode</em></a>) – the full config to be used</p></li>
<li><p><strong>args</strong> (<em>argparse.NameSpace</em>) – the command line arguments to be logged</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="xmodaler.engine.default_writers">
<code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">default_writers</code><span class="sig-paren">(</span><em class="sig-param">output_dir: str</em>, <em class="sig-param">max_iter: Optional[int] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#default_writers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.default_writers" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">EventWriter</span></code> to be used.
It now consists of a <code class="xref py py-class docutils literal notranslate"><span class="pre">CommonMetricPrinter</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorboardXWriter</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONWriter</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> – directory to store JSON metrics and tensorboard events</p></li>
<li><p><strong>max_iter</strong> – the total number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">EventWriter</span></code> objects.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[EventWriter]</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.HookBase">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">HookBase</code><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for hooks that can be registered with <a class="reference internal" href="#xmodaler.engine.TrainerBase" title="xmodaler.engine.TrainerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerBase</span></code></a>.</p>
<p>Each hook can implement 4 methods. The way they are called is demonstrated
in the following snippet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hook</span><span class="o">.</span><span class="n">before_train</span><span class="p">()</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_iter</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
    <span class="n">hook</span><span class="o">.</span><span class="n">before_step</span><span class="p">()</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="n">hook</span><span class="o">.</span><span class="n">after_step</span><span class="p">()</span>
<span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">hook</span><span class="o">.</span><span class="n">after_train</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p>In the hook method, users can access <code class="docutils literal notranslate"><span class="pre">self.trainer</span></code> to access more
properties about the context (e.g., model, current iteration, or config
if using <a class="reference internal" href="#xmodaler.engine.DefaultTrainer" title="xmodaler.engine.DefaultTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultTrainer</span></code></a>).</p></li>
<li><p>A hook that does something in <a class="reference internal" href="#xmodaler.engine.HookBase.before_step" title="xmodaler.engine.HookBase.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a> can often be
implemented equivalently in <a class="reference internal" href="#xmodaler.engine.HookBase.after_step" title="xmodaler.engine.HookBase.after_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_step()</span></code></a>.
If the hook takes non-trivial time, it is strongly recommended to
implement the hook in <a class="reference internal" href="#xmodaler.engine.HookBase.after_step" title="xmodaler.engine.HookBase.after_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_step()</span></code></a> instead of <a class="reference internal" href="#xmodaler.engine.HookBase.before_step" title="xmodaler.engine.HookBase.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a>.
The convention is that <a class="reference internal" href="#xmodaler.engine.HookBase.before_step" title="xmodaler.engine.HookBase.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a> should only take negligible time.</p>
<p>Following this convention will allow hooks that do care about the difference
between <a class="reference internal" href="#xmodaler.engine.HookBase.before_step" title="xmodaler.engine.HookBase.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a> and <a class="reference internal" href="#xmodaler.engine.HookBase.after_step" title="xmodaler.engine.HookBase.after_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_step()</span></code></a> (e.g., timer) to
function properly.</p>
</li>
</ol>
<dl class="method">
<dt id="xmodaler.engine.HookBase.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.HookBase.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.HookBase.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase.before_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.HookBase.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.HookBase.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#HookBase.state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.HookBase.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.HookBase.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.HookBase.trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A weak reference to the trainer object. Set by the trainer when the hook is registered.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.TrainerBase">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">TrainerBase</code><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for iterative trainer with hooks.</p>
<p>The only assumption we made here is: the training runs in a loop.
A subclass can implement what the loop is.
We made no assumptions about the existence of dataloader, optimizer, model, etc.</p>
<dl class="attribute">
<dt id="xmodaler.engine.TrainerBase.iter">
<code class="sig-name descname">iter</code><a class="headerlink" href="#xmodaler.engine.TrainerBase.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>the current iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.TrainerBase.start_iter">
<code class="sig-name descname">start_iter</code><a class="headerlink" href="#xmodaler.engine.TrainerBase.start_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>The iteration to start with.
By convention the minimum possible value is 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.TrainerBase.max_iter">
<code class="sig-name descname">max_iter</code><a class="headerlink" href="#xmodaler.engine.TrainerBase.max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>The iteration to end training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.TrainerBase.storage">
<code class="sig-name descname">storage</code><a class="headerlink" href="#xmodaler.engine.TrainerBase.storage" title="Permalink to this definition">¶</a></dt>
<dd><p>An EventStorage that’s opened during the course of training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="utils.html#xmodaler.utils.events.EventStorage" title="xmodaler.utils.events.EventStorage">EventStorage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.after_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.before_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.before_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.before_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.load_state_dict">
<code class="sig-name descname">load_state_dict</code><span class="sig-paren">(</span><em class="sig-param">state_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.load_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.register_hooks">
<code class="sig-name descname">register_hooks</code><span class="sig-paren">(</span><em class="sig-param">hooks: List[Optional[xmodaler.engine.train_loop.HookBase]]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.register_hooks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.register_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Register hooks to the trainer. The hooks are executed in the order
they are registered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hooks</strong> (<em>list</em><em>[</em><em>Optional</em><em>[</em><a class="reference internal" href="#xmodaler.engine.HookBase" title="xmodaler.engine.HookBase"><em>HookBase</em></a><em>]</em><em>]</em>) – list of hooks</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.run_step">
<code class="sig-name descname">run_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.run_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.run_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.TrainerBase.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">start_iter: int</em>, <em class="sig-param">max_iter: int</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/train_loop.html#TrainerBase.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.TrainerBase.train" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_iter</strong> (<em>start_iter</em><em>,</em>) – See docs above</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.CallbackHook">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">CallbackHook</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">before_train=None</em>, <em class="sig-param">after_train=None</em>, <em class="sig-param">before_step=None</em>, <em class="sig-param">after_step=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>Create a hook using callback functions provided by the user.</p>
<dl class="method">
<dt id="xmodaler.engine.CallbackHook.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">before_train=None</em>, <em class="sig-param">after_train=None</em>, <em class="sig-param">before_step=None</em>, <em class="sig-param">after_step=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Each argument is a function that takes one argument: the trainer.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.CallbackHook.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.CallbackHook.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.CallbackHook.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook.before_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.CallbackHook.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#CallbackHook.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.CallbackHook.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.CallbackHook.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.CallbackHook.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.CallbackHook.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.CallbackHook.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.IterationTimer">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">IterationTimer</code><span class="sig-paren">(</span><em class="sig-param">warmup_iter=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>Track the time spent for each iteration (each run_step call in the trainer).
Print a summary in the end of training.</p>
<p>This hook uses the time between the call to its <a class="reference internal" href="#xmodaler.engine.IterationTimer.before_step" title="xmodaler.engine.IterationTimer.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a>
and <a class="reference internal" href="#xmodaler.engine.IterationTimer.after_step" title="xmodaler.engine.IterationTimer.after_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_step()</span></code></a> methods.
Under the convention that <a class="reference internal" href="#xmodaler.engine.IterationTimer.before_step" title="xmodaler.engine.IterationTimer.before_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_step()</span></code></a> of all hooks should only
take negligible amount of time, the <a class="reference internal" href="#xmodaler.engine.IterationTimer" title="xmodaler.engine.IterationTimer"><code class="xref py py-class docutils literal notranslate"><span class="pre">IterationTimer</span></code></a> hook should be
placed at the beginning of the list of hooks to obtain accurate timing.</p>
<dl class="method">
<dt id="xmodaler.engine.IterationTimer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">warmup_iter=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>warmup_iter</strong> (<em>int</em>) – the number of iterations at the beginning to exclude
from timing.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.IterationTimer.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.IterationTimer.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.IterationTimer.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer.before_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.IterationTimer.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#IterationTimer.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.IterationTimer.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.IterationTimer.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.IterationTimer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.IterationTimer.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.IterationTimer.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.PeriodicWriter">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">PeriodicWriter</code><span class="sig-paren">(</span><em class="sig-param">writers</em>, <em class="sig-param">period=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicWriter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>Write events to EventStorage (by calling <code class="docutils literal notranslate"><span class="pre">writer.write()</span></code>) periodically.</p>
<p>It is executed every <code class="docutils literal notranslate"><span class="pre">period</span></code> iterations and after the last iteration.
Note that <code class="docutils literal notranslate"><span class="pre">period</span></code> does not affect how data is smoothed by each writer.</p>
<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">writers</em>, <em class="sig-param">period=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicWriter.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>writers</strong> (<em>list</em><em>[</em><em>EventWriter</em><em>]</em>) – a list of EventWriter objects</p></li>
<li><p><strong>period</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicWriter.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicWriter.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicWriter.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.PeriodicWriter.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.PeriodicWriter.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.PeriodicCheckpointer">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">PeriodicCheckpointer</code><span class="sig-paren">(</span><em class="sig-param">checkpointer: fvcore.common.checkpoint.Checkpointer</em>, <em class="sig-param">period: int</em>, <em class="sig-param">max_iter: Optional[int] = None</em>, <em class="sig-param">max_to_keep: Optional[int] = None</em>, <em class="sig-param">file_prefix: str = 'model'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicCheckpointer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.checkpoint.xmodaler_checkpoint.PeriodicEpochCheckpointer</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>Same as <code class="xref py py-class docutils literal notranslate"><span class="pre">detectron2.checkpoint.PeriodicCheckpointer</span></code>, but as a hook.</p>
<p>Note that when used as a hook,
it is unable to save additional data other than what’s defined
by the given <cite>checkpointer</cite>.</p>
<p>It is executed every <code class="docutils literal notranslate"><span class="pre">period</span></code> iterations and after the last iteration.</p>
<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">checkpointer: fvcore.common.checkpoint.Checkpointer</em>, <em class="sig-param">period: int</em>, <em class="sig-param">max_iter: Optional[int] = None</em>, <em class="sig-param">max_to_keep: Optional[int] = None</em>, <em class="sig-param">file_prefix: str = 'model'</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/fvcore/common/checkpoint.html#PeriodicCheckpointer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpointer</strong> – the checkpointer object used to save checkpoints.</p></li>
<li><p><strong>period</strong> (<em>int</em>) – the period to save checkpoint.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em>) – maximum number of iterations. When it is reached,
a checkpoint named “{file_prefix}_final” will be saved.</p></li>
<li><p><strong>max_to_keep</strong> (<em>int</em>) – maximum number of most current checkpoints to keep,
previous checkpoints will be deleted</p></li>
<li><p><strong>file_prefix</strong> (<em>str</em>) – the prefix of checkpoint’s filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicCheckpointer.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PeriodicCheckpointer.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">**kwargs: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/fvcore/common/checkpoint.html#PeriodicCheckpointer.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Same argument as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Checkpointer.save()</span></code>.
Use this method to manually save checkpoints outside the schedule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – file name.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – extra data to save, same as in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Checkpointer.save()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PeriodicCheckpointer.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">iteration: int</em>, <em class="sig-param">epoch: int</em>, <em class="sig-param">**kwargs: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the appropriate action at the given iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – the current iteration, ranged in [0, max_iter-1].</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – extra data to save, same as in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Checkpointer.save()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.PeriodicCheckpointer.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.PeriodicCheckpointer.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.LRScheduler">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">LRScheduler</code><span class="sig-paren">(</span><em class="sig-param">optimizer=None</em>, <em class="sig-param">scheduler=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#LRScheduler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.LRScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>A hook which executes a torch builtin LR scheduler and summarizes the LR.
It is executed after every iteration.</p>
<dl class="method">
<dt id="xmodaler.engine.LRScheduler.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">optimizer=None</em>, <em class="sig-param">scheduler=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#LRScheduler.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.LRScheduler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – </p></li>
<li><p><strong>scheduler</strong> (<em>torch.optim.LRScheduler</em>) – </p></li>
</ul>
</dd>
</dl>
<p>If any argument is not given, will try to obtain it from the trainer.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.LRScheduler.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#LRScheduler.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.LRScheduler.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.LRScheduler.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.LRScheduler.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.LRScheduler.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.LRScheduler.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.LRScheduler.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#LRScheduler.before_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.LRScheduler.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.LRScheduler.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.LRScheduler.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.LRScheduler.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.LRScheduler.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.AutogradProfiler">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">AutogradProfiler</code><span class="sig-paren">(</span><em class="sig-param">enable_predicate</em>, <em class="sig-param">output_dir</em>, <em class="sig-param">*</em>, <em class="sig-param">use_cuda=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#AutogradProfiler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.AutogradProfiler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>A hook which runs <cite>torch.autograd.profiler.profile</cite>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hooks</span><span class="o">.</span><span class="n">AutogradProfiler</span><span class="p">(</span>
     <span class="k">lambda</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">trainer</span><span class="o">.</span><span class="n">iter</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">trainer</span><span class="o">.</span><span class="n">iter</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">OUTPUT_DIR</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The above example will run the profiler for iteration 10~20 and dump
results to <code class="docutils literal notranslate"><span class="pre">OUTPUT_DIR</span></code>. We did not profile the first few iterations
because they are typically slower than the rest.
The result files can be loaded in the <code class="docutils literal notranslate"><span class="pre">chrome://tracing</span></code> page in chrome browser.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When used together with NCCL on older version of GPUs,
autograd profiler may cause deadlock because it unnecessarily allocates
memory on every device it sees. The memory management calls, if
interleaved with NCCL calls, lead to deadlock on GPUs that do not
support <code class="docutils literal notranslate"><span class="pre">cudaLaunchCooperativeKernelMultiDevice</span></code>.</p>
</div>
<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">enable_predicate</em>, <em class="sig-param">output_dir</em>, <em class="sig-param">*</em>, <em class="sig-param">use_cuda=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#AutogradProfiler.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable_predicate</strong> (<em>callable</em><em>[</em><em>trainer -&gt; bool</em><em>]</em>) – a function which takes a trainer,
and returns whether to enable the profiler.
It will be called once every step, and can be used to select which steps to profile.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – the output directory to dump tracing files.</p></li>
<li><p><strong>use_cuda</strong> (<em>bool</em>) – same as in <cite>torch.autograd.profiler.profile</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#AutogradProfiler.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#AutogradProfiler.before_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.AutogradProfiler.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.AutogradProfiler.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.AutogradProfiler.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.EvalHook">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">EvalHook</code><span class="sig-paren">(</span><em class="sig-param">eval_period</em>, <em class="sig-param">eval_function</em>, <em class="sig-param">iters_per_epoch</em>, <em class="sig-param">stage</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#EvalHook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.EvalHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>Run an evaluation function periodically, and at the end of training.</p>
<p>It is executed every <code class="docutils literal notranslate"><span class="pre">eval_period</span></code> iterations and after the last iteration.</p>
<dl class="method">
<dt id="xmodaler.engine.EvalHook.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">eval_period</em>, <em class="sig-param">eval_function</em>, <em class="sig-param">iters_per_epoch</em>, <em class="sig-param">stage</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#EvalHook.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.EvalHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_period</strong> (<em>int</em>) – the period to run <cite>eval_function</cite>. Set to 0 to
not evaluate periodically (but still after the last iteration).</p></li>
<li><p><strong>eval_function</strong> (<em>callable</em>) – a function which takes no arguments, and
returns a nested dict of evaluation metrics.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This hook must be enabled in all or none workers.
If you would like only certain workers to perform evaluation,
give other workers a no-op function (<cite>eval_function=lambda: None</cite>).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook._do_eval">
<code class="sig-name descname">_do_eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#EvalHook._do_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.EvalHook._do_eval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#EvalHook.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.EvalHook.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#EvalHook.after_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.EvalHook.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.EvalHook.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.EvalHook.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.EvalHook.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.EvalHook.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.EvalHook.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.EvalHook.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.PreciseBN">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">PreciseBN</code><span class="sig-paren">(</span><em class="sig-param">period</em>, <em class="sig-param">model</em>, <em class="sig-param">data_loader</em>, <em class="sig-param">num_iter</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PreciseBN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PreciseBN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.HookBase</span></code></p>
<p>The standard implementation of BatchNorm uses EMA in inference, which is
sometimes suboptimal.
This class computes the true average of statistics rather than the moving average,
and put true averages to every BN layer in the given model.</p>
<p>It is executed every <code class="docutils literal notranslate"><span class="pre">period</span></code> iterations and after the last iteration.</p>
<dl class="method">
<dt id="xmodaler.engine.PreciseBN.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">period</em>, <em class="sig-param">model</em>, <em class="sig-param">data_loader</em>, <em class="sig-param">num_iter</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PreciseBN.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PreciseBN.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>period</strong> (<em>int</em>) – the period this hook is run, or 0 to not run during training.
The hook will always run in the end of training.</p></li>
<li><p><strong>model</strong> (<em>nn.Module</em>) – a module whose all BN layers in training mode will be
updated by precise BN.
Note that user is responsible for ensuring the BN layers to be
updated are in training mode when this hook is triggered.</p></li>
<li><p><strong>data_loader</strong> (<em>iterable</em>) – it will produce data to be run by <cite>model(data)</cite>.</p></li>
<li><p><strong>num_iter</strong> (<em>int</em>) – number of iterations used to compute the precise
statistics.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PreciseBN.after_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PreciseBN.after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PreciseBN.after_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PreciseBN.before_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PreciseBN.before_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the first iteration.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.PreciseBN.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks are stateless by default, but can be made checkpointable by
implementing <cite>state_dict</cite> and <cite>load_state_dict</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.PreciseBN.trainer">
<code class="sig-name descname">trainer</code><em class="property">: TrainerBase</em><em class="property"> = None</em><a class="headerlink" href="#xmodaler.engine.PreciseBN.trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.PreciseBN.update_stats">
<code class="sig-name descname">update_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/hooks.html#PreciseBN.update_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.PreciseBN.update_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model with precise statistics. Users can manually call this method.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.DefaultTrainer">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">DefaultTrainer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.train_loop.TrainerBase</span></code></p>
<p>A trainer with default training logic. It does the following:</p>
<ol class="arabic simple">
<li><p>Create a <a class="reference internal" href="#xmodaler.engine.DefaultTrainer" title="xmodaler.engine.DefaultTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultTrainer</span></code></a> using model, optimizer, dataloader
defined by the given config. Create a LR scheduler defined by the config.</p></li>
<li><p>Load the last checkpoint or <cite>cfg.MODEL.WEIGHTS</cite>, if exists, when
<cite>resume_or_load</cite> is called.</p></li>
<li><p>Register a few common hooks defined by the config.</p></li>
</ol>
<p>It is created to simplify the <strong>standard model training workflow</strong> and reduce code boilerplate
for users who only need the standard training workflow, with standard features.
It means this class makes <em>many assumptions</em> about your training logic that
may easily become invalid in a new research. In fact, any assumptions beyond those made in the
<a class="reference internal" href="#xmodaler.engine.DefaultTrainer" title="xmodaler.engine.DefaultTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultTrainer</span></code></a> are too much for research.</p>
<p>The code of this class has been annotated about restrictive assumptions it makes.
When they do not work for you, you’re encouraged to:</p>
<ol class="arabic simple">
<li><p>Overwrite methods of this class, OR:</p></li>
<li><p>Use <a class="reference internal" href="#xmodaler.engine.DefaultTrainer" title="xmodaler.engine.DefaultTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultTrainer</span></code></a>, which only does minimal SGD training and
nothing else. You can then add your own hooks if needed. OR:</p></li>
<li><p>Write your own training loop similar to <cite>train_net.py</cite>.</p></li>
</ol>
<p>See the <a class="reference internal" href="../tutorials/training.html"><span class="doc">Training</span></a> tutorials for more details.</p>
<p>Note that the behavior of this class, like other functions/classes in
this file, is not stable, since it is meant to represent the “common default behavior”.
It is only guaranteed to work well with the standard models and training workflow in X-modaler.
To obtain more stable behavior, write your own training logic with other public APIs.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="n">DefaultTrainer</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">resume_or_load</span><span class="p">()</span>  <span class="c1"># load last checkpoint or MODEL.WEIGHTS</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="xmodaler.engine.DefaultTrainer.scheduler">
<code class="sig-name descname">scheduler</code><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.DefaultTrainer.checkpointer">
<code class="sig-name descname">checkpointer</code><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.checkpointer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkpoint.html#xmodaler.checkpoint.XmodalerCheckpointer" title="xmodaler.checkpoint.XmodalerCheckpointer">XmodalerCheckpointer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="xmodaler.engine.DefaultTrainer.cfg">
<code class="sig-name descname">cfg</code><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="config.html#xmodaler.config.CfgNode" title="xmodaler.config.CfgNode">CfgNode</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cfg</strong> (<a class="reference internal" href="config.html#xmodaler.config.CfgNode" title="xmodaler.config.CfgNode"><em>CfgNode</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer._write_metrics">
<code class="sig-name descname">_write_metrics</code><span class="sig-paren">(</span><em class="sig-param">loss_dict: Dict[str, torch.Tensor], data_time: float, prefix: str = ''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer._write_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer._write_metrics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_dict</strong> (<em>dict</em>) – dict of scalar losses</p></li>
<li><p><strong>data_time</strong> (<em>float</em>) – time taken by the dataloader iteration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.after_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.auto_scale_workers">
<em class="property">static </em><code class="sig-name descname">auto_scale_workers</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">num_workers: int</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.auto_scale_workers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.auto_scale_workers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.before_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.before_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_hooks">
<code class="sig-name descname">build_hooks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_hooks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_losses">
<em class="property">classmethod </em><code class="sig-name descname">build_losses</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_losses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_losses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_lr_scheduler">
<em class="property">classmethod </em><code class="sig-name descname">build_lr_scheduler</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">iters_per_epoch</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_lr_scheduler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_lr_scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_model">
<em class="property">classmethod </em><code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_optimizer">
<em class="property">classmethod </em><code class="sig-name descname">build_optimizer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_test_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_test_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_test_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_test_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_train_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_train_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_train_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_train_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_val_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_val_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_val_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_val_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.build_writers">
<code class="sig-name descname">build_writers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.build_writers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.build_writers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.load_state_dict">
<code class="sig-name descname">load_state_dict</code><span class="sig-paren">(</span><em class="sig-param">state_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.load_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.register_hooks">
<code class="sig-name descname">register_hooks</code><span class="sig-paren">(</span><em class="sig-param">hooks: List[Optional[xmodaler.engine.train_loop.HookBase]]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#xmodaler.engine.DefaultTrainer.register_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Register hooks to the trainer. The hooks are executed in the order
they are registered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hooks</strong> (<em>list</em><em>[</em><em>Optional</em><em>[</em><a class="reference internal" href="#xmodaler.engine.HookBase" title="xmodaler.engine.HookBase"><em>HookBase</em></a><em>]</em><em>]</em>) – list of hooks</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.resume_or_load">
<code class="sig-name descname">resume_or_load</code><span class="sig-paren">(</span><em class="sig-param">resume=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.resume_or_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.resume_or_load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.run_step">
<code class="sig-name descname">run_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.run_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the standard training logic described above.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.test">
<em class="property">classmethod </em><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em>, <em class="sig-param">test_data_loader</em>, <em class="sig-param">evaluator</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.DefaultTrainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/defaults.html#DefaultTrainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.DefaultTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
start_iter, max_iter (int): See docs above</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.RetrievalTrainer">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">RetrievalTrainer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/retrieval_trainer.html#RetrievalTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.defaults.DefaultTrainer</span></code></p>
<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/retrieval_trainer.html#RetrievalTrainer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
cfg (CfgNode):</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer._write_metrics">
<code class="sig-name descname">_write_metrics</code><span class="sig-paren">(</span><em class="sig-param">loss_dict: Dict[str, torch.Tensor], data_time: float, prefix: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer._write_metrics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_dict</strong> (<em>dict</em>) – dict of scalar losses</p></li>
<li><p><strong>data_time</strong> (<em>float</em>) – time taken by the dataloader iteration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.after_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.auto_scale_workers">
<em class="property">static </em><code class="sig-name descname">auto_scale_workers</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">num_workers: int</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.auto_scale_workers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.before_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.before_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_hooks">
<code class="sig-name descname">build_hooks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_losses">
<em class="property">classmethod </em><code class="sig-name descname">build_losses</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_losses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_lr_scheduler">
<em class="property">classmethod </em><code class="sig-name descname">build_lr_scheduler</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">iters_per_epoch</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_lr_scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_model">
<em class="property">classmethod </em><code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_optimizer">
<em class="property">classmethod </em><code class="sig-name descname">build_optimizer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_test_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_test_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_test_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_train_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_train_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_train_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_val_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_val_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_val_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.build_writers">
<code class="sig-name descname">build_writers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.build_writers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.load_state_dict">
<code class="sig-name descname">load_state_dict</code><span class="sig-paren">(</span><em class="sig-param">state_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.register_hooks">
<code class="sig-name descname">register_hooks</code><span class="sig-paren">(</span><em class="sig-param">hooks: List[Optional[xmodaler.engine.train_loop.HookBase]]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.register_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Register hooks to the trainer. The hooks are executed in the order
they are registered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hooks</strong> (<em>list</em><em>[</em><em>Optional</em><em>[</em><a class="reference internal" href="#xmodaler.engine.HookBase" title="xmodaler.engine.HookBase"><em>HookBase</em></a><em>]</em><em>]</em>) – list of hooks</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.resume_or_load">
<code class="sig-name descname">resume_or_load</code><span class="sig-paren">(</span><em class="sig-param">resume=True</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.resume_or_load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.run_step">
<code class="sig-name descname">run_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the standard training logic described above.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.test">
<em class="property">classmethod </em><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em>, <em class="sig-param">test_data_loader</em>, <em class="sig-param">evaluator</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/retrieval_trainer.html#RetrievalTrainer.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RetrievalTrainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RetrievalTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
start_iter, max_iter (int): See docs above</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xmodaler.engine.RLTrainer">
<em class="property">class </em><code class="sig-prename descclassname">xmodaler.engine.</code><code class="sig-name descname">RLTrainer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/rl_trainer.html#RLTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RLTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">xmodaler.engine.defaults.DefaultTrainer</span></code></p>
<dl class="method">
<dt id="xmodaler.engine.RLTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/rl_trainer.html#RLTrainer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RLTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
cfg (CfgNode):</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer._write_metrics">
<code class="sig-name descname">_write_metrics</code><span class="sig-paren">(</span><em class="sig-param">loss_dict: Dict[str, torch.Tensor], data_time: float, prefix: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer._write_metrics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_dict</strong> (<em>dict</em>) – dict of scalar losses</p></li>
<li><p><strong>data_time</strong> (<em>float</em>) – time taken by the dataloader iteration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.after_step">
<code class="sig-name descname">after_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.after_train">
<code class="sig-name descname">after_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.after_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.auto_scale_workers">
<em class="property">static </em><code class="sig-name descname">auto_scale_workers</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">num_workers: int</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.auto_scale_workers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.before_step">
<code class="sig-name descname">before_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.before_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.before_train">
<code class="sig-name descname">before_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.before_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_hooks">
<code class="sig-name descname">build_hooks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_hooks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_losses">
<em class="property">classmethod </em><code class="sig-name descname">build_losses</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_losses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_lr_scheduler">
<em class="property">classmethod </em><code class="sig-name descname">build_lr_scheduler</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">iters_per_epoch</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_lr_scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_model">
<em class="property">classmethod </em><code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_optimizer">
<em class="property">classmethod </em><code class="sig-name descname">build_optimizer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_scorer">
<em class="property">classmethod </em><code class="sig-name descname">build_scorer</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/rl_trainer.html#RLTrainer.build_scorer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_scorer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_test_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_test_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_test_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_train_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_train_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_train_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_val_loader">
<em class="property">classmethod </em><code class="sig-name descname">build_val_loader</code><span class="sig-paren">(</span><em class="sig-param">cfg</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_val_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.build_writers">
<code class="sig-name descname">build_writers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.build_writers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.load_state_dict">
<code class="sig-name descname">load_state_dict</code><span class="sig-paren">(</span><em class="sig-param">state_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.register_hooks">
<code class="sig-name descname">register_hooks</code><span class="sig-paren">(</span><em class="sig-param">hooks: List[Optional[xmodaler.engine.train_loop.HookBase]]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#xmodaler.engine.RLTrainer.register_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Register hooks to the trainer. The hooks are executed in the order
they are registered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hooks</strong> (<em>list</em><em>[</em><em>Optional</em><em>[</em><a class="reference internal" href="#xmodaler.engine.HookBase" title="xmodaler.engine.HookBase"><em>HookBase</em></a><em>]</em><em>]</em>) – list of hooks</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.resume_or_load">
<code class="sig-name descname">resume_or_load</code><span class="sig-paren">(</span><em class="sig-param">resume=True</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.resume_or_load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.run_step">
<code class="sig-name descname">run_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xmodaler/engine/rl_trainer.html#RLTrainer.run_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xmodaler.engine.RLTrainer.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the standard training logic described above.</p>
</dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.test">
<em class="property">classmethod </em><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param">cfg</em>, <em class="sig-param">model</em>, <em class="sig-param">test_data_loader</em>, <em class="sig-param">evaluator</em><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="xmodaler.engine.RLTrainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#xmodaler.engine.RLTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
start_iter, max_iter (int): See docs above</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="evaluation.html" class="btn btn-neutral float-right" title="xmodaler.evaluation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="datasets.html" class="btn btn-neutral float-left" title="xmodaler.datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Yehao Li.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>